# **Module Federation vs Single SPA: Какой подход выбрать для микрофронтендов?**

Микрофронтенды — подход к разработке веб\-приложений, позволяющий разделить проект на независимые части. Среди инструментов для реализации микрофронтендов наиболее распространены [Module Federation](https://module-federation.io/) и [Single SPA](https://single-spa.js.org/). Оба подхода решают схожие задачи, но отличаются по принципу работы, гибкости и сферам применения

## **Что такое Module Federation?**

**Module Federation** — технология, которая позволяет приложениям делиться модулями (например, компонентами, утилитами или библиотеками) на уровне загрузки во время выполнения (*runtime*). Отлично подходит для построения гибкой и переиспользуемой архитектуры фронтенда


### **Преимущества**

1. **Деление кода на уровне модулей**:  
   * позволяет приложениям динамически подключать модули (компоненты, утилиты) из других приложений  
   * загружаемые модули не дублируются, если они уже есть в памяти  
2. **Интеграция с современными сборщиками**:
   * возможно использование с Vite, благодаря плагинам, адаптирующим Module Federation.  
3. **Модульный рефакторинг**:
   * позволяет постепенно разделять большой монолит на микрофронтенды, сохраняя производительность

### **Недостатки**

* требуется дополнительная настройка, чтобы работать с Vite или Rollup.  
* сложности с управлением версиями модулей в больших системах  
* отсутствует управление жизненным циклом приложений

## **Когда использовать?**

**Module Federation** идеально подходит, если:

* все микрофронтенды написаны на одном фреймворке (например, React или Vue)  
* вы хотите сосредоточиться на переиспользуемых модулях, таких как общие компоненты (header, footer, UI-библиотека)  
* важна высокая производительность

## **Как использовать?**

[Репозиторий с примером подключения 3 сервисов к сайдбару](https://github.com/TourmalineCore/vite-module-federation) с использованием Module Federation на vite

## **Что такое Single SPA?**

**Single SPA** — библиотека для оркестрации микрофронтендов. Позволяет объединять несколько приложений, которые могут быть написаны на разных фреймворках (React, Angular, Vue, Svelte или даже Vanilla JS), на одной странице

### **Преимущества**

1. **Поддержка различных технологий**:  
   * позволяет объединять приложения, написанные на разных фреймворках или даже бандлерах (Webpack, Vite, Rollup и т.д.)  
2. **Динамическая загрузка микрофронтендов**:  
   * загружает и подключает только те микрофронтенды, которые нужны в текущий момент  
3. **Фокус на изоляции**:  
   * каждый микрофронтенд изолирован, что упрощает их независимую разработку и деплой  
4. **Оркестрация**:  
   * встроенная маршрутизация и управление жизненным циклом приложений

### **Недостатки**

* более сложная настройка по сравнению с Module Federation  
* оптимизация производительности требует дополнительной работы (например, устранение дублирования зависимостей)  
* настраивать деление кода и совместимость библиотек нужно в каждом сервисе  
* изменения подгружаются не во время выполнения (*runtime*), нужно пересобирать сервис с изменениями

## **Когда использовать?**

**Single SPA** стоит выбрать, если:

* в проекте используются разные технологии или фреймворки (например, React, Angular, Vue)  
* вы хотите централизованно управлять маршрутизацией и жизненным циклом приложений  
* сервисы работают независимо, и вы хотите минимизировать взаимозависимости  
* разрабатываете сложное приложение, где каждый микрофронтенд должен быть изолирован

## **Как использовать?**

[Репозиторий с примером подключения 3 сервисов к сайдбару](https://github.com/TourmalineCore/vite-single-spa/tree/master) с использованием single spa на vite

## **Сравнение Module Federation и Single SPA**

| Характеристика | Module Federation | Single SPA |
| :---- | :---- | :---- |
| **Технологическая зависимость** | Современные сборщики (Vite, Webpack) | Любой стек |
| **Динамическая загрузка** | Модули (компоненты, утилиты) | Целые микрофронтенды |
| **Устранение дублирования зависимостей** | Автоматическое | Настраивается вручную |
| **Оркестрация** | Отсутствует | Встроенная (маршруты, жизненный цикл) |
| **Использование разных технологий** | Не поддерживается | Поддерживается |
| **Производительность** | Высокая | Зависит от настройки |
| **Удобство внедрения** | Простое для проектов на Webpack | Гибче, но сложнее на старте |

## **Можно ли комбинировать оба подхода?**

Да\! В сложных проектах оба инструмента могут дополнять друг друга:

* **Single SPA** для оркестрации микрофронтендов на уровне маршрутов  
* **Module Federation** внутри каждого микрофронтенда для загрузки компонентов и утилит из других приложений

Такой подход позволяет извлечь лучшее из обеих технологий, сохранив гибкость и высокую производительность

## **Вывод**

**Module Federation** и **Single SPA** решают схожие задачи, но делают это по-разному. Если проект построен на одном фреймворке и вы ищете простой способ разделения модулей, выбирайте **Module Federation**. Если же вам нужно объединить приложения на разных технологиях, управлять маршрутизацией и жизненным циклом — ваш выбор **Single SPA**

## Наш выбор

Для проекта **Inner Circle** не требуется объединение разных технологий, т.к. все написано на одной - Vite & React 18. Также нужно просто расшарить компоненты сайдбара, хеддера и футера между всеми сервисами => наш выбор **Module Federation**.

**Ресурсы**

1. [Ссылка на статью](https://habr.com/ru/articles/826590/), которая помогла понять главную проблему работы single spa на vite и подсказала [ссылку на нужный конфиг](https://github.com/sw1tch3roo/single-spa-example-service/blob/systemjs/vite.config.ts)

2. [Микросервисы на фронтенде — что выбрать](https://habr.com/ru/companies/sportmaster_lab/articles/724314/)

3. [Гайд по микрофронтендам на single-spa, или Как уже наконец-то уйти от монолита во фронтенде](https://habr.com/ru/companies/ecom_tech/articles/766978/)

4. [Вдали от Webpack, или Как мы в Dodo микрофронтенды на Vite переводили](https://habr.com/ru/companies/dododev/articles/715988/)

5. [Создание масштабируемой архитектуры с помощью Module Federation — Роман Желтов, Сбер](https://youtu.be/y8HWxJCr45w)  
6. [Вадим Малютин — Как готовить production с Webpack 5 module federation](https://youtu.be/ugkOEg5xJCA)

